<!DOCTYPE html>
<html data-ng-app="fruitTree">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    <title>Letters</title>
    <script src="js/angular.js"></script>
    <script src="https://cdn.firebase.com/v0/firebase.js"></script>
    <script src="https://cdn.firebase.com/libs/angularfire/0.5.0/angularfire.js"></script>
    <script type="application/javascript" src="js/angular-letters.js"></script>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/letters.css" rel="stylesheet">
    <script src="js/ui-bootstrap-tpls-0.10.0.js"></script>

    <!--  <script src="js/angular-deckgrid.js"></script> -->
 <!-- Masonry script seemed a little bit difficult because of a need to re-layout on element add.

   <script src="js/masonry.pkgd.min.js"></script>
    <script>
        docReady( function() {

            var container = document.querySelector('#sayings-container');
            var msnry = new Masonry( container, {
                columnWidth: 200
            });
            msnry.layout();
        });

    </script>
    -->


</head>
<body>
<div  class="app" id="fruit" data-ng-controller="lettersCtrl">
    <div class="">
        <div class="top-bttns">
            Total <span class="label label-primary">{{root.sayings.length}}</span> sayings.
        <div class="btn-group btn-group-xs">
            <button type="button" class="btn btn-xs btn-success" data-ng-click="saveToFireBase()">Save to database</button>
            <button type="button" class="btn btn-xs btn-warning" data-ng-click="loadFromFireBase()">Load from database</button>
            <button onclick="document.getElementById('usertext').focus()" class="btn btn-xs btn-danger" data-ng-click="reset()">Restart</button>
        </div>
        </div>
    </div>


    {{width}}

    <div  class="saypanel">
        <button data-ng-init="hidden=true" type="button" class="btn btn-md btn-success" data-ng-click="hidden = !hidden">Создать</button>
        <form data-ng-submit="root.say(root.pretaken)">
        <div class="types" data-collapse="hidden">
            Выбери тип высказывания: <div class="btn-group btn-group-md">
                <button type="button" data-ng-repeat="type in types" data-ng-model="$parent.sayingType" data-btn-radio="type" class="btn btn-md btn-primary">{{type}}</button>
            </div>
        </div>


        <div class="orders" data-collapse="hidden">
        Выбери порядок:
            <button type="button" onclick="document.getElementById('usertext').focus()"
                    class="btn btn-md order color-{{getColor(root.pretaken)}}"
                    data-ng-click="root.pretaken=''">
                {{root.pretaken || root.freeOrders.length}}
            </button>
        <input type="search" class="input-sm pretake" data-ng-model="pretake">
        <button data-ng-disabled="$parent.root.pretaken!=''" type="button" onclick="document.getElementById('usertext').focus()"
                class="btn btn-md order color-{{getColor(order)}}"
                data-ng-repeat="order in root.freeOrders | filter:pretake | limitTo: 12 "
                data-ng-click="root.pretakeOrder(order)">
            {{order}}
        </button>
        </div>
        <div data-ng-show="sayingType && root.pretaken">
           <h3>{{sayingType}}</h3>
            <label for="usertext">Название</label>
            <input autofocus id="usertext"
                   data-tooltip="Осталось {{140 - $parent.linkedText.length}} символов"
                   data-tooltip-trigger="focus" data-tooltip-placement="top"
                   data-ng-model="$parent.linkedText"
                   data-ng-model-instant
                   class="form-control">
            <label for="picture">URL картинки</label>
            <input autofocus id="picture"
                   data-ng-model="picLink"
                   data-ng-model-instant
                   class="form-control">
            <button class="btn btn-success" data-ng-click="root.say(root.pretaken, sayingType, picLink, linkedText);pretake='';sayingType='';picLink='';hidden=true">Создать</button>
        </div>
        </form>
    </div>


    <div data-ng-init="columner()">
    Zoom: <input data-ng-init="cols=4" type="range"  min="1" max="{{colsmax}}" data-ng-model="cols" data-ng-model-instant>
    <span class="label label-default">{{cols}}</span>
    </div>
<!-- Columns layout made with CSS columns ONLY! For further analysis.

    <div class="row sayings">
        <div class="col-md-10 col-md-offset-1 row" >
        <div id="sayings-container">
            <div data-ng-repeat="saying in sayings track by $id(saying)" class="square border-color-{{getColor(saying.letter)}}">
                <span class="label color-{{getColor(saying.letter)}}">{{saying.letter}}</span>
                {{saying.text}}

            </div>
        </div>
        </div>
    </div>

HERE IS THE CSS
<style>
#sayings-container {
    -moz-column-count: 3;
    -moz-column-gap: 10px;
    -webkit-column-count: 3;
    -webkit-column-gap: 10px;
    column-count: 3;
    column-gap: 10px;
    display:block;
    clear:both;
    width:100%;

}

.sayings {
    margin-bottom: 300px;
}
.square {
    display:inline-block;
    width:99%%;
    padding:6px;
    border: solid 6px #ccc;
    margin: 4px 4px;
    overflow: hidden;
</style>

-->

<!-- DECKGRID

    <div class="row sayings">
        <div class="col-md-10 col-md-offset-1" id="sayings-container">

            <div deckgrid source="root.sayings" cardTemplate="js/saying.html" class="deckgrid"></div>

         </div>
    </div>

-->

<!-- Just a description list as the first version.
    <div class="row">
        <div class="col-md-7">
            <dl class="dl-horizontal">
                <dt data-ng-repeat-start="why in sayings track by why.letter"><span class="label label-{{getButtonStatus(why)}}">{{why.letter}}</span></dt>
                <dd data-ng-repeat-end=""> {{why.text}}</dd>

            </dl>
        </div>
    </div>
-->


    <div class="sayings">
        <div class="" id="sayings-container">
        <div data-ng-init="card.select=''"
            data-ng-style="{'width':$parent.width/$parent.cols -5 +'px', 'background-image':'url('+card.picLink+')', 'background-size':$parent.width/$parent.cols+'px', 'background-position':'center', 'background-repeat':'no-repeat'}"
            data-ng-repeat="card in root.sayings | orderBy:root.ratingSort"
            data-ng-class="card.select"
            class="box hover-back-{{getColor(card.order)}} border-color-{{getColor(card.order)}}">

            <div  data-ng-show="card.select == ''" data-ng-click="card.select='color-'+getColor(card.order);" class="pane-label hover-back-{{getColor(card.order)}}">
                | {{card.order}} |
            </div>
            <div  data-ng-class="card.select" data-ng-hide="card.select == ''" data-ng-click="card.select=''" class="pane-label hover-back-{{getColor(card.order)}}">
                | {{card.order}} |
            </div>



        <div class="rating">
            <span data-ng-show="root[card.order].getRating()<0" data-ng-click="root[card.order].rate('-')" class="label label-danger">{{root[card.order].getRating()}}</span>
            <span data-ng-hide="root[card.order].getRating()<0" data-ng-click="root[card.order].rate('-')" class="minus label label-danger">-</span>
            <span data-ng-click="root[card.order].rate('0')" class="zero label label-default">{{root[card.order].getTotal() || 0}}</span>
            <span data-ng-show="root[card.order].getRating()>0" data-ng-click="root[card.order].rate('+')" class="label label-success">+{{root[card.order].getRating()}}</span>
            <span data-ng-hide="root[card.order].getRating()>0" data-ng-click="root[card.order].rate('+')" class="plus label label-success">+</span>
        </div>



            <div data-ng-if="!card.more" class="saying-text" >
                {{card.text.substring(0,140)}}<span ng-if="card.text.length>139">...</span>
            </div>
            <div data-ng-if="card.more" class="saying-text">
                {{card.text}}
            </div>

            <div data-ng-if="card.text.length > 140 && !card.more"
                 data-ng-click="card.more = true"
                 class="corner">
                <div class="more">+</div>
            </div>
            <div data-ng-if="card.more"
                 data-ng-click="card.more = false"
                 class="corner">
                <div class="less">-</div>
            </div>

        </div>
        </div>
    </div>




</div>
</body>
</html>